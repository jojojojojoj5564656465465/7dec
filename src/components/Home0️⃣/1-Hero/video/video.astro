---
// VideoPlayer.astro
interface Props {
  mediaId: string
}

const { mediaId } = Astro.props
---

<div class="video-container">
  <wistia-player media-id={mediaId}></wistia-player>
</div>

<style>
  .video-container {
    position: relative;
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
  }

  /* Style pour l'état non-défini (avant le chargement du player) */
  :global(wistia-player:not(:defined)) {
    background: center / contain no-repeat;
    background-image: url(`https://fast.wistia.com/embed/medias/${mediaId}/swatch`);
    display: block;
    filter: blur(5px);
    padding-top: 56.25%; /* Ratio 16:9 */
  }
</style>

<script>
  // Chargement dynamique du player Wistia
  const loadWistiaScript = () => {
    if (!document.querySelector('script[src*="wistia.com/player.js"]')) {
      const script = document.createElement('script')
      script.src = 'https://fast.wistia.com/player.js'
      script.async = true
      document.head.appendChild(script)
    }
  }

  // Chargement du script quand le composant est monté
  loadWistiaScript()
</script>
<script src="https://fast.wistia.com/player.js" async></script><script src="https://fast.wistia.com/embed/ajtj2xpipw.js" async type="module"></script><style>